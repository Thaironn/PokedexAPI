<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Press+Start+2P&display=swap" rel="stylesheet">

  <title>Pokémon API</title>
  <link rel="stylesheet" href="poke.css">
</head>

<body>

  <div id="container">
    <h1>Pokédex</h1>
    <a href="pc.html">
      <button>
        <img src="https://static.wikia.nocookie.net/tkoc/images/8/87/Pok%C3%A9_Ball.png/revision/latest?cb=20200626174824&path-prefix=pt-br" style="width: 50px; height: 50px;" alt="Descrição da imagem">
      </button>
    </a>
  </div>

  <div class="pokeContainer" id="pokeContainer">

  </div>

  <script>
    document.addEventListener('DOMContentLoaded', async () => {
        const pokeContainer = document.querySelector("#pokeContainer"); // Corrigido para pokeContainer
        const pokemonCount = 20;
        const colors = {
            fire: '#FF0000', //Arrumar o tons das cores
            grass: '#DEFDE0',
            electric: '#FCF7DE',
            water: '#DEF3FD',
            ground: '#f4e7da',
            rock: '#d5d5d4',
            fairy: '#fceaff',
            poison: '#98d7a5',
            bug: '#f8d5a3',
            dragon: '#97b3e6',
            psychic: '#eaeda1',
            flying: '#F5F5F5',
            fighting: '#E6E0D4',
            normal: '#F5F5F5'
        };

        const mainTypes = Object.keys(colors);

        const fetchPokemons = async () => {
            for (let i = 1; i < pokemonCount; i++) {
                await getPokemons(i);
            }
        };

        const getPokemons = async (id) => {          
            const url = `https://pokeapi.co/api/v2/pokemon/${id}`;
            const resp = await fetch(url);
            const data = await resp.json();
            pokemonCard(data);
        };

        const pokemonCard = (poke) => {
            const card = document.createElement('div');
            card.classList.add("pokemon");

            const name = poke.name[0].toUpperCase() + poke.name.slice(1); //Nome do pokemon
            const id = poke.id.toString().padStart(3, '0'); //id do pokemon

            const pokemonTypes = poke.types.map(type => type.type.name); //Encontra o tipo do pokeon
            const type =  mainTypes.find(type => pokemonTypes.indexOf(type) > -1); //Tipo principal do pokemon
            const color = colors[type]; //Cor do tipo

            card.style.backgroundColor = color; //Vai mudar a coloração do card

            const pokemonInnerHTML = `

                <div class="vercomprar">

                  <a href="info.html">
                    <button>
                      <img src="https://e7.pngegg.com/pngimages/1002/949/png-clipart-certification-organization-energetics-magnifying-glass-others-glass-cdr.png" style="width: 50px; height: 50px;" alt="">
                    </button>
                  </a>

                  <a>
                    <button>
                      <img src="" style="width: 50px; height: 50px;" alt="">
                    </button>
                  </a>

                </div>    

                <div class="imgContainer">
                  <img src="https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/${poke.id}.png" alt="${name}">
                </div>
                
                <div class="info">
                  <span class="number" style="color: white;">#${id}</span>
                  <h3 class="name">${name}</h3>
                  <small class="type"> Tipo: <span>${type}</span></small>
                </div>
            `; //Contrução de como vai ficar os pokemons
            
            card.innerHTML = pokemonInnerHTML;

            if (pokeContainer) {
                pokeContainer.appendChild(card);
            } else {
                console.error("Elemento com ID 'pokeContainer' não encontrado.");
            }
        };

        fetchPokemons();
    });
  </script>

</body>

</html>
